<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.2/angular.min.js"></script>
    
    <title>AshRated // Colony Command Console</title>
    
    <script type="text/javascript">
        const itemListURL = "https://raw.githubusercontent.com/AshRated/item-list/master/StoreItems.json";
        const eventListURL = "https://raw.githubusercontent.com/AshRated/item-list/master/StoreEvents.json";
        const shopExtURL = "https://raw.githubusercontent.com/AshRated/item-list/master/ShopExt.json";
        const commandsURL = "https://raw.githubusercontent.com/AshRated/item-list/master/commands.json";
    </script>

    <style>
        /* --- RIMWORLD CONSOLE STYLES --- */
        body {
            background-color: #0d1117; /* Darkest space background */
            font-family: 'Verdana', 'Geneva', sans-serif; /* RimWorld's standard font family */
            color: #d2d2d2; /* Standard UI text color */
            padding-top: 70px;
        }

        /* Scanline Overlay for the CRT feel */
        body::before {
            content: " ";
            display: block;
            position: fixed;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 9999;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* Glass Panels = RimWorld UI Windows */
        .rim-window {
            background-color: #262d33; /* Exact RimWorld UI Background */
            border: 2px solid #3c444d;
            border-radius: 4px; /* RimWorld uses very slight rounding, almost square */
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }

        .navbar {
            background-color: #1e2328 !important;
            border-bottom: 3px solid #3c444d;
        }

        .navbar-brand {
            font-weight: bold;
            color: #d2d2d2 !important;
            letter-spacing: 1px;
        }

        /* Tabs = Pawn Info Tabs */
        .btn-tab {
            background-color: #313a42;
            color: #d2d2d2;
            border: 1px solid #4a545e;
            border-bottom: none;
            padding: 10px 25px;
            margin-right: 5px;
            border-radius: 4px 4px 0 0;
            font-size: 0.85rem;
            cursor: pointer;
            text-transform: uppercase;
        }

        .btn-tab:hover { background-color: #4a545e; color: #fff; }
        
        /* Active States based on RimWorld colors */
        .btn-tab.active-1 { background-color: #2ecc71; color: #000; font-weight: bold; } /* Green Resources */
        .btn-tab.active-2 { background-color: #e74c3c; color: #fff; font-weight: bold; } /* Red Events */
        .btn-tab.active-3 { background-color: #f1c40f; color: #000; font-weight: bold; } /* Yellow Traits */
        .btn-tab.active-4 { background-color: #3498db; color: #fff; font-weight: bold; } /* Blue Commands */
        .btn-tab.active-5 { background-color: #9b59b6; color: #fff; font-weight: bold; } /* Purple Guide */

        /* Tables */
        .table { background-color: rgba(0,0,0,0.2); border: 1px solid #3c444d; color: #d2d2d2; }
        .table thead th { border-bottom: 2px solid #3c444d; color: #a1a1a1; font-size: 0.8rem; }
        .table-hover tbody tr:hover { background-color: rgba(255,255,255,0.05); }

        /* Input styling */
        .rim-input {
            background-color: #0d1117;
            border: 1px solid #4a545e;
            color: #00bc8c; /* Terminal Green */
            font-family: 'JetBrains Mono', monospace;
        }

        .twitch-wrapper {
            border: 4px solid #3c444d;
            background: #000;
            height: 500px;
        }

        .cmd-text {
            font-family: 'JetBrains Mono', monospace;
            color: #00bc8c;
        }

        .guide-box {
            background-color: rgba(0,0,0,0.3);
            border-left: 4px solid #9b59b6;
            padding: 15px;
            margin-bottom: 15px;
        }
    </style>
</head>

<body ng-app='tabs' ng-controller='tabCtrl'>

    <nav class="navbar navbar-expand-md navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">ASH RATED // COLONY COMMAND CONSOLE</a>
            <div class="ml-auto">
                <span class="badge badge-success p-2">SYSTEMS ONLINE</span>
            </div>
        </div>
    </nav>

    <main class="container-fluid mt-4 px-lg-5">
        
        <div class="row">
            <div class="col-lg-9 mb-3">
                <div class="twitch-wrapper">
                    <iframe src="https://player.twitch.tv/?channel=ashrated&parent=ashrated.github.io&muted=false" height="100%" width="100%" frameborder="0" allowfullscreen="true"></iframe>
                </div>
            </div>
            <div class="col-lg-3 mb-3">
                <div class="twitch-wrapper">
                    <iframe src="https://www.twitch.tv/embed/ashrated/chat?parent=ashrated.github.io&darkpopout" height="100%" width="100%" frameborder="0"></iframe>
                </div>
            </div>
        </div>

        <div class="d-flex flex-wrap mt-2">
            <div class="btn-tab" ng-class="{'active-1': selected == 1}" ng-click='selected=1'>Inventory</div>
            <div class="btn-tab" ng-class="{'active-2': selected == 2}" ng-click='selected=2'>Incidents</div>
            <div class="btn-tab" ng-class="{'active-3': selected == 3}" ng-click='selected=3'>Genetics</div>
            <div class="btn-tab" ng-class="{'active-4': selected == 4}" ng-click='selected=4'>Terminal</div>
            <div class="btn-tab" ng-class="{'active-5': selected == 5}" ng-click='selected=5'>Manual</div>
        </div>

        <div class="rim-window">
            
            <div class="row mb-4" ng-show="selected != 5">
                <div class="col-md-8">
                    <div class="input-group">
                        <div class="input-group-prepend"><span class="input-group-text rim-input border-right-0">FILTER_QUERY:</span></div>
                        <input type="text" id="searchBar" class="form-control rim-input" placeholder="Type name to search...">
                    </div>
                </div>
                <div class="col-md-4" ng-show="selected != 4">
                    <div class="input-group">
                        <div class="input-group-prepend"><span class="input-group-text rim-input border-right-0">$</span></div>
                        <input type="number" id="priceMax" class="form-control rim-input" placeholder="Max Price">
                    </div>
                </div>
            </div>

            <div id="displayArea">
                
                <div ng-show="selected == 1" id="items">
                    <table class="table table-hover">
                        <thead><tr><th>OBJECT_ID</th><th>MARKET_VALUE</th><th>CATEGORY</th></tr></thead>
                        <tbody class="list"></tbody>
                    </table>
                </div>

                <div ng-show="selected == 2" id="events">
                    <table class="table table-hover">
                        <thead><tr><th>INCIDENT_ID</th><th>THREAT_LEVEL_COST</th><th>KARMA</th></tr></thead>
                        <tbody class="list"></tbody>
                    </table>
                </div>

                <div ng-show="selected == 3" id="traits">
                    <table class="table table-hover">
                        <thead><tr><th>MOD_ID</th><th>FUNCTION</th><th>ADD_COST</th><th>REM_COST</th></tr></thead>
                        <tbody class="list"></tbody>
                    </table>
                </div>

                <div ng-show="selected == 4" id="commands">
                    <table class="table table-hover">
                        <thead><tr><th>INPUT_STRING</th><th>OPERATION</th><th>ACCESS</th></tr></thead>
                        <tbody class="list"></tbody>
                    </table>
                </div>

                <div ng-show="selected == 5">
                    <h2 class="text-uppercase mb-4" style="color:#9b59b6">Instructional Manual</h2>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="guide-box">
                                <h5 class="text-success">CREDIT ACCUMULATION</h5>
                                <p class="small">Watch time generates passive Silver. Subs/Bit donors receive priority multipliers. Check wallet with <span class="cmd-text">!bal</span>.</p>
                            </div>
                            <div class="guide-box">
                                <h5 class="text-info">SUPPLY REQUISITION</h5>
                                <p class="small">Items drop via Orbital Trade Pod. Avoid dropping directly on colonists. Format: <span class="cmd-text">!buy [item] [qty]</span>.</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="guide-box">
                                <h5 class="text-warning">COLONIST INTEGRATION</h5>
                                <p class="small">Enter the queue with <span class="cmd-text">!joinqueue</span>. Use <span class="cmd-text">!mypawnskills</span> to monitor your health and efficiency.</p>
                            </div>
                            <div class="guide-box">
                                <h5 class="text-danger">INCIDENT TRIGGER</h5>
                                <p class="small">Forces game events. Hostile events cost more but generate 'Good Karma'. Format: <span class="cmd-text">!buy [event]</span>.</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <footer class="text-center pb-5 small opacity-50">
            SYSTEM VERSION 3.1 // ASHRATED_OS
        </footer>
    </main>

    <script type="text/javascript">
        // Lists
        let itemList, eventList, traitList, commandList;

        $.getJSON(itemListURL, function(data) {
            itemList = new List('items', { valueNames: ['abr', 'price', 'category'], item: '<tr><td class="abr font-weight-bold"></td><td class="price text-success"></td><td class="category opacity-50"></td></tr>' }, data.items.filter(i => i.price > 0));
        });

        $.getJSON(eventListURL, function(data) {
            eventList = new List('events', { valueNames: ['abr', 'price', 'karmatype'], item: '<tr><td class="abr font-weight-bold"></td><td class="price text-danger"></td><td class="karmatype"></td></tr>' }, data.incitems.filter(i => i.price > 0));
        });

        $.getJSON(shopExtURL, function(data) {
            let combined = [];
            if(data.traits) data.traits.forEach(t => combined.push({ name: t.defName, desc: t.description, add: t.addPrice, rem: t.removePrice }));
            if(data.races) data.races.filter(r => r.enabled).forEach(r => combined.push({ name: r.defName + " (Race)", desc: r.description, add: r.price, rem: "N/A" }));
            traitList = new List('traits', { valueNames: ['name', 'desc', 'add', 'rem'], item: '<tr><td class="name text-warning font-weight-bold"></td><td class="desc small"></td><td class="add"></td><td class="rem"></td></tr>' }, combined);
        });

        $.getJSON(commandsURL, function(data) {
            commandList = new List('commands', { valueNames: ['usage', 'description', 'userLevel'], item: '<tr><td class="usage cmd-text"></td><td class="description small"></td><td class="userLevel font-weight-bold"></td></tr>' }, data);
        });

        // Combined Search and Filter
        $(document).on('keyup', '#searchBar, #priceMax', function() {
            let search = $('#searchBar').val();
            let max = $('#priceMax').val();
            let filter = (item) => {
                let p = parseInt(item.values().price || item.values().add || 0);
                return (max === "" || p <= max);
            };
            [itemList, eventList, traitList, commandList].forEach(l => { if(l){ l.search(search); l.filter(filter); }});
        });

        angular.module('tabs', []).controller('tabCtrl', function($scope) { $scope.selected = "1"; });
    </script>
</body>
</html>
